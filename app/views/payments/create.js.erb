(function(){
  <% if @payment.new_record? %>
    alert('<%= j @payment.errors.full_messages.join("\n") -%>');
  <% else %>
    let tr = byid('installment_<%= @installment.id -%>');
    tr.insertAdjacentHTML('afterend', '<%= j(installment_tr(@installment)) %>');
    tr.remove();
    closeModal();
    <% if params[:button] == 'save_and_receipt' %>
      showReceiptModal(<%= @payment.receipt %>);
    <% end %>
  <% end %>
})()